women <- read.csv("women.csv")
fly <- read.csv("fruitfly.csv")
setwd("~/GitHub/QTM200Spring2020/problem_sets/PS2") #copy/paste from getwd
getwd() #double check
library(readr)
fly <- read.csv("fruitfly.csv")
summary(fly)
histogram(fly$lifespan)
hist(fly$lifespan)
summary_stat <- summary(fly)
table(summary_stat)
display(summary_stat)
#####################
# Problem 2
#####################
women <- read.csv("https://raw.githubusercontent.com/kosukeimai/qss/master/PREDICTION/women.csv")
women
View(women)
r <- (cov(women$water, women$irrigation))/(sd(women$water)*sd(women$irrigation))
r
#weak-moderate positive correlation
#test statistic
n <- dim(women)
n
#weak-moderate positive correlation
#test statistic
n <- dim(women)[1]
#weak-moderate positive correlation
#test statistic
n <- length(women)
n
#weak-moderate positive correlation
#test statistic
n <- samplesize(women)
#weak-moderate positive correlation
#test statistic
summary(women)
#weak-moderate positive correlation
#test statistic
width(women)
#weak-moderate positive correlation
#test statistic
n <- dim(women$GP)
#weak-moderate positive correlation
#test statistic
n <- dim(women)
#weak-moderate positive correlation
#test statistic
n <- dim(women)[1,]
#weak-moderate positive correlation
#test statistic
n <- dim(women)[1]
tstat <- (r*sqrt(n-2))/sqrt(1-r^2)
2*pt(t_stat, n-2, lower.tail=F)
2*pt(tstat, n-2, lower.tail=F)
pval <- 2*pt(tstat, n-2, lower.tail=F)
pval
cor(women$irrigation, women$water, method="pearson")
r
cor.test(women$irrigation, women$water, method="pearson")
#Run bivariate regression
r <- (cov(women$water, women$female))/(sd(women$water)*sd(women$female))
r
#Run bivariate regression
r <- (cov(women$water, women$female))/(sd(women$water)*sd(women$female))
r
plot(women$water, women$female)
hist(fly$lifespan)
#Plot lifespan vs. thorax
plot(fly$lifespan, fly$thorax,
xlab="Lifespan (days)", ylab="Thorax length (mm)")
#r of lifespan vs. thorax
r2 <- (cov(fly$lifespan, fly$thorax))/(sd(fly$lifespan)*sd(fly$thorax))
r2
#Regress lifespan on thorax. Interpret the slope of the fitted model.
mean(fly$thorax)
mean(fly$lifespan)
sum(fly$thorax)
sigmathoraxy <- sum(fly$thorax)
sigmathorax_y <- sum(fly$thorax)
sigmalifespan_x <- sum(fly$lifespan)
sigmalifespan_x <- sum(fly$lifespan) # =
#Regress lifespan on thorax. Interpret the slope of the fitted model.
mean_y <- mean(fly$thorax) #y-bar = 0.8206
mean_x <- mean(fly$lifespan) #x-bar = 57.44
fly$thorax-mean_y
yybar <- (fly$thorax-mean_y)
xxbar <- (fly$lifespan-mean_x)
xxyy <- (xxbar*yybar)
xxyy
sum(xxyy)
sqxxrbar <- (xxbar)^2
sqxxbar
sqxxbar <- (xxbar)^2
sqxxbar
sqxxbar
sum(xxyy)
sqxxbar2 <- sum(sqxxbar)
sqxxbar2
beta <- (sum(xxyy))/sqxxbar2
beta
lm(fly$thorax ~ fly$lifespan, data=fly)
alpha <- mean_y - (beta*mean_x)
alpha
plot(fly$thorax,fly$lifespan)
#Plot lifespan vs. thorax
plot(fly$lifespan, fly$thorax,
xlab="Lifespan (days)", ylab="Thorax length (mm)")
#Plot lifespan vs. thorax
plot(fly$lifespan, fly$thorax,
xlab="Lifespan (days)", ylab="Thorax length (mm)")
#Test for a significant linear relationship between lifespan and thorax
n <- dim(fly)
#Test for a significant linear relationship between lifespan and thorax
n_fly <- dim(fly)
#Test for a significant linear relationship between lifespan and thorax
n_fly <- dim(fly)[1]
fly_teststat<- (r2*sqrt(n_fly-2))/sqrt(1-(r2)^2)
2*pt(fly_teststat, n_fly-2, lower.tail=F)
cor.test(fly$thorax, fly$lifespan)
#90% CI for slope
#Using typical CI formula
moe <- fly_teststat/
lm(fly$thorax~fly$lifespan)
#90% CI for slope
#Using typical CI formula
moe <- fly_teststat/
lm(fly$thorax~fly$lifespan)
#90% CI for slope
#Using typical CI formula
moe <- fly_teststat/
lm(fly$thorax~fly$lifespan, data=fly)
#90% CI for slope
#Using typical CI formula
moe <- fly_teststat/
lm(fly$thorax ~ fly$lifespan, data=fly)
#90% CI for slope
#Using typical CI formula
moe <- fly_teststat/
lm(fly$thorax ~ fly$lifespan, data=fly)
lm(fly$thorax ~ fly$lifespan, data=fly)
#90% CI for slope
#Using typical CI formula
moe <- fly_teststat/
lm(fly$thorax ~ fly$lifespan, data=fly)
lm(fly$thorax ~ fly$lifespan, data=fly)
summary(lm)
summary(lm)
mod = lm(fly$thorax ~ fly$lifespan, data=fly)
summary(mod)
fly_teststat<- (r2*sqrt(n_fly-2))/sqrt(1-(r2)^2)
#90% CI for slope
#Using typical CI formula
test_stat <- beta/0.0003067
#90% CI for slope
#Using typical CI formula
test_statCI <- beta/0.0003067
test_statCI
fly_teststat
fly_teststat
2*pt(fly_teststat, n_fly-2, lower.tail=F)
fly_teststat
#standard error = 0.0003067
moe <- (fly_teststat*0.0003067)
moe
lower_90 <- beta - moe
upper_90 <- beta + moe
ci90 <- c(lower_90, upper_90)
ci90
#90% CI for slope
#Calc critical value
a <- (1-(90/100))
p <- 1 - (a/2)
critprob <- 1 - (a/2)
df <- n_fly - 2
#critical value = 1.645
critvalue <- 1.645
#standard error = 0.0003067
moe2 <- critvalue*0.0003067
lower_90b <- beta - moe2
upper_90b <- beta + moe2
ci90b <- c(lower_90b, upper_90b)
ci90b
# 90% confidence interval is (0.0023, 0.0033)
confintfunc <- lm(fly$thorax ~ fly$lifespan, data=fly)
summary(mod)
confint(confintfunc)
confint(confintfunc, level=0.90)
ci90b
predict(confintfunc, newdata=df, interval = "confidence", level=0.90)
predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata=df, interval = "confidence", level=0.90)
predict(lm(fly$thorax ~ fly$lifespan, data=fly),
newdata=df, interval = "confidence", level=0.90)
new_fly <- confintfunc; new_fly$thorax <- 0.8
predict(confintfunc, newdata =  new_fly, se.fit=T)
predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata =  new_fly, se.fit=T)
new_fly <- fly; new_fly$thorax <- 0.8
predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata =  new_fly, se.fit=T)
predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata =  new_fly, se.fit=T)
predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata=new_fly, interval="prediction", level=0.90)
predicintervals <- predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata=new_fly, interval="prediction", level=0.90)
table(predicintervals)
new_fly$thorax <- 0.8
predict(lm(fly$thorax ~ fly$lifespan), newdata=new_fly, se.fit=T)
new_fly <- fly; new_fly$thorax <- 0.8
new_fly$thorax <- 0.8
predict(lm(fly$thorax ~ fly$lifespan), newdata=new_fly, se.fit=T)
#Prediction
predicintervals <- predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata=new_fly, interval="prediction", level=0.90)
predicintervals
predict(lm(fly$thorax ~ fly$lifespan), newdata=new_fly, se.fit=T)
new_fly <- fly; new_fly$thorax <- 0.8
predict(lm(fly$thorax ~ fly$lifespan), newdata=new_fly, se.fit=T)
predicintervals
confintfunc2 <- lm(fly$lifespan ~ fly$thorax, data=fly)
predicintervals2 <- predict(confintfunc2, data=fly, newdata=new_fly, interval="prediction", level=0.90)
predicintervals2
predicintervals <- predict(lm(fly$thorax ~ fly$lifespan, data=fly), newdata=new_fly, interval="prediction", level=0.90)
predicintervals
new_fly <- fly; new_fly$thorax <- 0.8
predict(lm(fly$thorax ~ fly$lifespan), newdata=new_fly, se.fit=T)
predicintervals2 <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly2, interval="prediction", level=0.90)
predicintervals2
new_fly2 <- fly; new_fly$thorax <- 0.8
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
predicintervals2
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
# 90% confidence interval is (0.0023, 0.0033)
confintfunc <- lm(fly$thorax ~ fly$lifespan, data=fly)
confint(confintfunc, level=0.90)
r <- (cov(women$water, women$female))/(sd(women$water)*sd(women$female))
r
plot(women$water, women$female)
#weak positive correlation
#test statistic
n <- dim(women)[1]
tstat <- (r*sqrt(n-2))/sqrt(1-r^2)
2*pt(tstat, n-2, lower.tail=F)
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
#Prediction interval for (average?) lifespan when thorax length is 0.8 = (31.77, 77.05)
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
predicintervals2 <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly2, interval="prediction", level=0.90)
predicintervals2
new_fly2 <- fly; new_fly$thorax <- 0.8
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
#####################
# Problem 3
#####################
#Set wd and load fruitfly dataset
setwd("~/GitHub/QTM200Spring2020/problem_sets/PS2") #copy/paste from getwd
getwd() #double check
library(readr)
fly <- read.csv("fruitfly.csv")
summary(fly)
hist(fly$thorax)
#Plot thorax vs. lifespan
plot(fly$thorax, fly$lifespan,
xlab="thorax length (mm)", ylab="lifespan (days)")
#There appears to be a linear relationship between fruitfly thorax and lifespan length.
#r of thorax vs. lifespan
r2 <- (cov(fly$thorax, fly$lifespan))/(sd(fly$thorax)*sd(fly$lifespan))
r2
#There appears to be a linear relationship between fruitfly thorax and lifespan length.
#r of thorax vs. lifespan
r2 <- (cov(fly$thorax, fly$lifespan))/(sd(fly$thorax)*sd(fly$lifespan))
r2
#Regress thorax on lifespan. Interpret the slope of the fitted model.
mean_y <- mean(fly$lifespan) #y-bar = ?
#Regress thorax on lifespan. Interpret the slope of the fitted model.
mean_y <- mean(fly$lifespan) #y-bar = ?
mean_y
mean_x <- mean(fly$thorax) #x-bar = ?
sigmalifespan_y <- sum(fly$lifespan) # = ?
sigmalifespan_y
sigmathorax_x
sigmathorax_x <- sum(fly$thorax) # = ?
sigmathorax_x
sigmathorax_x <- sum(fly$thorax) # = 102.62
sigmathorax_x
yybar <- (fly$lifespan-mean_y)
xxbar <- (fly$thorax-mean_x)
xxyy <- (xxbar*yybar)
xxyy
xxyy
sum(xxyy) # = ?
sum(xxyy) # = 107.367
yybar <- (fly$lifespan-mean_y)
xxbar <- (fly$thorax-mean_x)
xxyy <- (xxbar*yybar)
xxyy
sum(xxyy) # = 107.367
sqxxbar <- (xxbar)^2
sqxxbar2 <- sum(sqxxbar)
sqxxbar2 # = ?
beta <- (sum(xxyy))/sqxxbar2
beta # = ?
alpha <- mean_y - (beta*mean_x)
alpha # = ?
lm(fly$lifespan ~ fly$thorax, data=fly)
#Test for a significant linear relationship between thorax and lifespan
n_fly <- dim(fly)[1]
fly_teststat<- (r2*sqrt(n_fly-2))/sqrt(1-(r2)^2)
2*pt(fly_teststat, n_fly-2, lower.tail=F)
#p-value = ~ 0
cor.test(fly$lifespan, fly$thorax)
#90% CI for slope
#Calc critical value
a <- (1-(90/100))
critprob <- 1 - (a/2) # = 0.95
df <- n_fly - 2 # = 123
#critical value = 1.645
critvalue <- 1.645
#Calc critical value
a <- (1-(90/100))
critprob <- 1 - (a/2) # = 0.95
df <- n_fly - 2 # = 123
#critical value = 1.645
critvalue <- 1.645
mod = lm(fly$thorax ~ fly$lifespan, data=fly)
summary(mod)
mod = lm(fly$lifespan ~ fly$thorax, data=fly)
summary(mod)
#standard error = 15.77
moe2 <- critvalue*15.77
lower_90b <- beta - moe2
upper_90b <- beta + moe2
ci90b <- c(lower_90b, upper_90b)
ci90b
# 90% confidence interval is (118.3915, 170.2748)
confintfunc <- lm(fly$lifespan ~ fly$thorax, data=fly)
confint(confintfunc, level=0.90)
predicintervals <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly, interval="prediction", level=0.90)
predicintervals
new_fly <- fly; new_fly$thorax <- 0.8
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly, se.fit=T)
predicintervals
new_fly2 <- fly; new_fly$thorax <- 0.8
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
newdatapredict <- predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
mean(newdatapredict)
table(newdatapredict)
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly2, se.fit=T)
#Change x and y
predicintervals2 <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly2, interval="prediction", level=0.90)
predicintervals2
predicintervals2
confint(confintfunc, level=0.90)
confintfunc
predicintervals <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly, interval="prediction", level=0.90)
predicintervals
confintfunc
new_fly <- fly; new_fly$thorax <- 0.8
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly, se.fit=T)
#Prediction of (average) lifespan (y) when thorax length (x) = 0.8
predicintervals <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly, interval="prediction", level=0.90)
predicintervals
confintervals
confintervals <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly, interval="confidence", level=0.90)
confintervals
plot(fly$thorax, fly$lifespan,
xlab="thorax length (mm)", ylab="lifespan (days)", main="Fruitfly lifespan (days) vs. thorax (mm)")
summary(fly$thorax)
newx <- seq(0.640,0.940, by=0.5)
lines(newx, predicintervals[,2], col="orange", lty=2)
lines(newx, predicintervals[,2], col="orange", lty=2)
plot(fly$thorax, fly$lifespan,
xlab="thorax length (mm)", ylab="lifespan (days)", main="Fruitfly lifespan (days) vs. thorax (mm)")
lines(newx, predicintervals[,2], col="orange", lty=2)
plot(fly$thorax, fly$lifespan,
xlab="thorax length (mm)", ylab="lifespan (days)", main="Fruitfly lifespan (days) vs. thorax (mm)")
lines(newx, predicintervals[,2], col="orange", lty=2)
lines(newx, predicintervals[,3], col="orange", lty=2)
plot(fly$thorax, fly$lifespan,
xlab="thorax length (mm)", ylab="lifespan (days)", main="Fruitfly lifespan (days) vs. thorax (mm)")
install.packages(ggplot2)
install.packages("ggplot2")
mydata <- cbind(fly, confintfunc)
newx <- seq(0.640,0.940, by=0.5)
plot(fly$thorax, fly$lifespan,
xlab="thorax length (mm)", ylab="lifespan (days)", main="Fruitfly lifespan (days) vs. thorax (mm)")
lines(newx, predicintervals[,2], col="orange", lty=2)
lines(newx, predicintervals[,3], col="orange", lty=2)
lines(newx, predicintervals[,3], col="orange", lty=2)
plot(women$water, women$female)
?predict
confintervals
predict(lm(fly$lifespan ~ fly$thorax), newdata=new_fly, se.fit=T)
predict(lm(lifespan ~ thorax), newdata=new_fly, se.fit=T)
new_fly <- fly; new_fly$thorax <- 0.8
predict(lm(lifespan ~ thorax), newdata=new_fly, se.fit=T)
new_fly
View(new_fly)
names(new_fly)
lm(lifespan ~ thorax, newdata=new_fly)
predict(lm(lifespan~thorax), newdata=new_fly, se.fit=T)
new_fly$lifespan
?lm
predict(lm(lifespan~thorax, newdata=new_fly), se.fit=T)
##################
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
# here is where you load any necessary packages
# ex: stringr
# lapply(c("stringr"),  pkgTest)
lapply(c(),  pkgTest)
lapply(c("stringr"),  pkgTest)
fly <- read.csv("fruitfly.csv")
#There appears to be a linear relationship between fruitfly thorax and lifespan length.
#r of thorax vs. lifespan
r2 <- (cov(fly$thorax, fly$lifespan))/(sd(fly$thorax)*sd(fly$lifespan))
r2
#Regress thorax on lifespan. Interpret the slope of the fitted model.
mean_y <- mean(fly$lifespan) #y-bar = 57.44
mean_y
mean_x <- mean(fly$thorax) #x-bar = 0.821
sigmalifespan_y <- sum(fly$lifespan) # = 7180
sigmalifespan_y
sigmathorax_x <- sum(fly$thorax) # = 102.62
sigmathorax_x
yybar <- (fly$lifespan-mean_y)
xxbar <- (fly$thorax-mean_x)
xxyy <- (xxbar*yybar)
xxyy
sum(xxyy) # = 107.367
sqxxbar <- (xxbar)^2
sqxxbar2 <- sum(sqxxbar)
sqxxbar2 # = 0.744
beta <- (sum(xxyy))/sqxxbar2
beta # = 144.33
alpha <- mean_y - (beta*mean_x)
alpha # = -61.0517
lm(fly$lifespan ~ fly$thorax, data=fly)
#Test for a significant linear relationship between thorax and lifespan
n_fly <- dim(fly)[1]
fly_teststat<- (r2*sqrt(n_fly-2))/sqrt(1-(r2)^2)
2*pt(fly_teststat, n_fly-2, lower.tail=F)
#p-value = ~ 0
cor.test(fly$lifespan, fly$thorax)
#90% CI for slope
#Calc critical value
a <- (1-(90/100))
critprob <- 1 - (a/2) # = 0.95
df <- n_fly - 2 # = 123
#critical value = 1.645
critvalue <- 1.645
mod = lm(fly$lifespan ~ fly$thorax, data=fly)
summary(mod)
#standard error = 15.77
moe2 <- critvalue*15.77
lower_90b <- beta - moe2
upper_90b <- beta + moe2
ci90b <- c(lower_90b, upper_90b)
ci90b
# 90% confidence interval is (118.3915, 170.2748)
confintfunc <- lm(fly$lifespan ~ fly$thorax, data=fly)
confint(confintfunc, level=0.90)
#Prediction of (average) lifespan (y) when thorax length (x) = 0.8
predicintervals <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly, interval="prediction", level=0.90)
#Prediction of (average) lifespan (y) when thorax length (x) = 0.8
new_fly <- fly; new_fly$thorax <- 0.8
View(new_fly)
predicintervals <- predict(lm(fly$lifespan ~ fly$thorax, data=fly), newdata=new_fly, interval="prediction", level=0.90)
predicintervals
predicintervals <- predict(confintfunc, newdata=new_fly, interval="prediction", level=0.90)
predicintervals
confintervals <- predict(confintfunc, newdata=new_fly, interval="confidence", level=0.90)
confintervals
plot(fly$thorax, fly$lifespan,
xlab="thorax length (mm)", ylab="lifespan (days)", main="Fruitfly lifespan (days) vs. thorax (mm)")
lines(newx, predicintervals[,2], col="orange", lty=2)
lines(newx, predicintervals[,3], col="orange", lty=2)
predicintervals
predicintervals[1]
confintintervals[1]
confintervals[1]
confintervals[1,2]
confintervals[1,3]
predicintervals[1,2]
predicintervals[1,3]
new_fly <- data.frame(thorax=0.8)
predicintervals <- predict(confintfunc, newdata=new_fly, interval="prediction", level=0.90)
# 90% confidence interval is (118.3915, 170.2748)
confintfunc <- lm(lifespan ~ thorax, data=fly)
predicintervals <- predict(confintfunc, newdata=new_fly, interval="prediction", level=0.90)
# 90% confidence interval is (118.3915, 170.2748)
confintfunc <- lm(lifespan ~thorax, data=fly)
confintfunc
#Prediction of (average) lifespan (y) when thorax length (x) = 0.8
new_fly <- data.frame(thorax=0.8)
predicintervals <- predict(confintfunc, newdata=new_fly, interval="prediction", level=0.90)
predicintervals
confintervals <- predict(confintfunc, newdata=new_fly, interval="confidence", level=0.90)
confintervals
predict(confintfunc, interval = "confidence")
